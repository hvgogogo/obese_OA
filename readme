# Single-cell RNA-seq Analysis of Synovial Fibroblasts in Obesity and Osteoarthritis

This repository contains R scripts for comprehensive single-cell RNA sequencing analysis of synovial tissue, focusing on synovial fibroblasts (SFs) in the context of obesity and osteoarthritis.

## Overview

The analysis pipeline processes single-cell RNA-seq data from synovial tissue samples across three conditions:
- **lean_healthy**: Healthy controls
- **lean_OA**: Non-obese osteoarthritis patients  
- **obese_OA**: Obese osteoarthritis patients

### Synovial Fibroblast Subtypes
- **SLSFs_CD34pos**: CD34-positive sublining synovial fibroblasts
- **SLSFs_CD34neg**: CD34-negative sublining synovial fibroblasts
- **LLSFs**: Lining layer synovial fibroblasts
- **SLSFs_IM**: Inflammatory sublining synovial fibroblasts

## File Structure

```
obese_OA/
├── README.md
├── run_analysis.R                    # Master script to run complete pipeline
├── scripts/
│   ├── 00_setup.R                    # Environment setup and configuration
│   ├── 01_data_loading.R             # Data loading and preprocessing
│   ├── 02_cell_characterization.R    # UMAP, markers, visualization
│   ├── 03_differential_expression.R  # DEG analysis with plots
│   ├── 04_pathway_enrichment.R       # Pathway enrichment analysis
│   ├── 05_gsea_analysis.R            # Gene Set Enrichment Analysis
│   └── 06_network_analysis.R         # PPI networks and hub genes
├── utils/
│   ├── plot_functions.R              # Reusable plotting functions
│   └── pathway_functions.R           # Pathway analysis utilities
├── config/
│   └── analysis_config.yaml          # Analysis parameters
├── data/                             # Input data files
├── results/                          # Generated outputs
│   ├── figures/                      # All plots and visualizations
│   ├── tables/                       # CSV/Excel result files
│   └── reports/                      # Summary reports and logs
```

## Analysis Components

### 1. **Cell Characterization**
- UMAP projections and cell type annotation
- Marker gene analysis and validation
- Expression heatmaps and density plots
- Cell proportion analysis across conditions

### 2. **Differential Expression Analysis**
- Cross-condition comparisons (weight, disease effects)
- Volcano and waterfall plots
- Statistical testing with multiple correction

### 3. **Pathway Enrichment Analysis**
- Multiple pathway databases (Hallmark, KEGG, Reactome, GO)
- Dot plots and custom pathway visualizations
- Gene Set Enrichment Analysis (GSEA)

### 4. **Network Analysis**
- Protein-protein interaction networks (STRING database)
- Hub gene identification using centrality measures
- Pathway-specific network visualization

## How to Use

### Option 1: Run Complete Pipeline
```r
# Run all analyses automatically
source("run_analysis.R")
```

### Option 2: Run Individual Steps
```r
# Step 1: Setup environment
source("scripts/00_setup.R")

# Step 2: Load data
source("scripts/01_data_loading.R")

# Step 3: Cell characterization
source("scripts/02_cell_characterization.R")

# Step 4: Differential expression
source("scripts/03_differential_expression.R")

# Step 5: Pathway enrichment
source("scripts/04_pathway_enrichment.R")

# Step 6: GSEA analysis
source("scripts/05_gsea_analysis.R")

# Step 7: Network analysis
source("scripts/06_network_analysis.R")
```

### Option 3: Custom Analysis
```r
# Load utility functions
source("utils/plot_functions.R")
source("utils/pathway_functions.R")

# Use individual functions for specific analyses
# See script files for available functions
```

## Prerequisites

### Required R Packages
```r
# Core analysis
install.packages(c("Seurat", "dplyr", "ggplot2", "patchwork"))

# Pathway analysis  
install.packages(c("clusterProfiler", "msigdbr", "fgsea"))

# Network analysis
install.packages(c("STRINGdb", "igraph", "ggraph"))

# Visualization
install.packages(c("pheatmap", "ggrepel", "Cairo"))
```

### Data Requirements
- Seurat objects with processed single-cell RNA-seq data
- Gene annotation file (biomart format)
- Update data paths in `scripts/00_setup.R` or `config/analysis_config.yaml`

## Key Outputs

- **Figures**: Publication-ready plots (PDF format)
- **Tables**: Differential expression results, pathway enrichment
- **Reports**: Analysis summary and session information
- **Network Data**: Hub gene rankings and interaction networks

## Configuration

Modify analysis parameters in:
- `scripts/00_setup.R` - Basic setup and paths
- `config/analysis_config.yaml` - Comprehensive parameter settings

## Citation

If you use this analysis pipeline, please cite the original research and acknowledge the tools used (Seurat, clusterProfiler, fgsea, etc.).

## Contact

For questions about this analysis pipeline, please open an issue on this repository.
